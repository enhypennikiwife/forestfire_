from pymongo import MongoClient
import re
import datetime
import numpy as np
client = MongoClient('mongodb+srv://pej2834:pej09180429@cluster0.ceosi8e.mongodb.net/?retryWrites=true&w=majority')
db = client.dbsparta

cause = list(db.forestcause.find({}, {'_id': False}))
print(cause[0]['cause_name'])

for i in range(124):
    click_forest = list(db.forestname.find({}, {'_id': False}))[0]['san_name']
    if (list(db.Ganwon_forestweather.find({}, {'_id': False}))[i]['mt'].split(' ')[1] == click_forest):
        tem = list(db.Ganwon_forestweather.find({}, {'_id': False}))[i]['tmp']
        hum = list(db.Ganwon_forestweather.find({}, {'_id': False}))[i]['hm']
        result1 = re.sub(r'[^0-9]', '.', tem)
        result2 = re.sub(r'[^0-9]', '', hum)
        list_addr = list(db.Ganwon_forestweather.find({}, {'_id': False}))[i]['addr']
        list_gungu = list_addr.split(" ")[1]
if list_gungu == "강릉시":
    gungu01 = 1
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "고성군":
    gungu01 = 0
    gungu02 = 1
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "동해시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 1
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "삼척시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 1
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "속초시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 1
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "양구군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 1
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "양양군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 1
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "영월군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 1
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "원주시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 1
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "인제군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 1
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "정선군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 1
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "철원군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 1
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "춘천시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 1
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "태백시":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 1
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "평창군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 1
    gungu16 = 0
    gungu17 = 0
    gungu18 = 0
if list_gungu == "홍천군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 1
    gungu17 = 0
    gungu18 = 0
if list_gungu == "화천군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 0
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 1
    gungu18 = 0
if list_gungu == "횡성군":
    gungu01 = 0
    gungu02 = 0
    gungu03 = 0
    gungu04 = 1
    gungu05 = 0
    gungu06 = 0
    gungu07 = 0
    gungu08 = 0
    gungu09 = 0
    gungu10 = 0
    gungu11 = 0
    gungu12 = 0
    gungu13 = 0
    gungu14 = 0
    gungu15 = 0
    gungu16 = 0
    gungu17 = 0
    gungu18 = 1
current = datetime.datetime.today().month
if (current == 3) or (current == 4) or (current == 5):
    season_spring = 1
    season_summer = 0
    season_autumn = 0
    season_winter = 0
if (current == 6) or (current == 7) or (current == 8):
    season_spring = 0
    season_summer = 1
    season_autumn = 0
    season_winter = 0
if (current == 9) or (current == 10) or (current == 11):
    season_spring = 0
    season_summer = 0
    season_autumn = 1
    season_winter = 0
if (current == 12) or (current == 1) or (current == 2):
    season_spring = 0
    season_summer = 0
    season_autumn = 0
    season_winter = 1
if current == 1:
    month1 = 1
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 2:
    month1 = 0
    month2 = 1
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 3:
    month1 = 0
    month2 = 0
    month3 = 1
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 4:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 1
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 5:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 1
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 6:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 1
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 7:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 1
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 8:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 1
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 0
if current == 9:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 1
    month10 = 0
    month11 = 0
    month12 = 0
if current == 10:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 1
    month11 = 0
    month12 = 0
if current == 11:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 1
    month12 = 0
if current == 12:
    month1 = 0
    month2 = 0
    month3 = 0
    month4 = 0
    month5 = 0
    month6 = 0
    month7 = 0
    month8 = 0
    month9 = 0
    month10 = 0
    month11 = 0
    month12 = 1
cause = list(db.forestcause.find({}, {'_id': False}))
if (cause[0]['cause_name'] == '건'):
    cause1 = 1
    cause2 = 0
    cause3 = 0
    cause4 = 0
    cause5 = 0
if (cause[0]['cause_name'] == '기'):
    cause1 = 0
    cause2 = 1
    cause3 = 0
    cause4 = 0
    cause5 = 0
if (cause[0]['cause_name'] == '담'):
    cause1 = 0
    cause2 = 0
    cause3 = 1
    cause4 = 0
    cause5 = 0
if (cause[0]['cause_name'] == '쓰'):
    cause1 = 0
    cause2 = 0
    cause3 = 0
    cause4 = 1
    cause5 = 0
if (cause[0]['cause_name'] == '입'):
    cause1 = 0
    cause2 = 0
    cause3 = 0
    cause4 = 0
    cause5 = 1
arr = np.array([[result1,result2,gungu01,gungu02,gungu03,gungu04,gungu05,gungu06,gungu07,gungu08,gungu09,gungu10,gungu10,gungu11,gungu11,gungu12,gungu13,gungu14,gungu15,gungu16,gungu17,gungu18,cause1,cause2,cause3,cause4,cause5,season_autumn,season_winter,season_spring,season_summer,month1,month10,month11,month12,month2,month3,month4,month5,month6,month7,month8,month9]])
arr_num = arr.astype(float)
print(arr_num)